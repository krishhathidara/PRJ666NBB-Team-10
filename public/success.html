<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shopping Cart</title>
  <link rel="stylesheet" href="/styles/base.css" />
  <script src="/scripts/ambient.js" defer></script>
  
</head>
<body>
<header class="nav glossy-nav">
  <a class="brand" href="/"><img src="/assets/logo.svg" alt="Logo"><strong>Grocery Web</strong></a>
  <nav class="mainnav" id="mainnav">
    <a href="/">Home</a>
    <a href="/nearby.html">Nearby Stores</a>
    <a class="active" href="/cart.html">Shopping Cart</a>
    <a href="/meal-plan.html">Meal Plan</a>
    <a href="/profile.html">Profile</a>
  </nav>
  <div class="account">
    <span id="account-guest">
      <a class="btn-outline" href="/auth/signin.html">Sign In</a>
      <a class="btn" style="margin-left:6px" href="/auth/signup.html">Sign Up</a>
    </span>
    <span id="account-user" style="display:none">
      <a href="/profile.html">Profile</a>
      <a id="logout-link" style="margin-left:10px" href="#">Logout</a>
    </span>
  </div>
</header>

  <main class="container">
  <section class="section">
    <div class="section-head">
      <h2>Thank You for Your Order!</h2>
    </div>
    <div class="card" style="padding:14px">
      <p>Payment successful via Credit Card.</p>
      <h3>Order Summary</h3>
      <div id="order-items"></div>
      <div style="display:flex; justify-content:space-between; font-weight:800; margin-top:12px">
        <div>Total Paid</div>
        <div>$<span id="order-total">0.00</span></div>
      </div>
    </div>
    <div style="margin-top: 20px; text-align: center;"><a href="/home.html" class="btn" style="margin-top:12px">Back to Main page</a> </div>
  </section>
</main>

<nav class="tabbar">
  <a class="tab" href="/" aria-label="Home"><svg viewBox="0 0 24 24" fill="none"><path d="M3 10.5 12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-7H9v7H4a1 1 0 0 1-1-1v-10.5Z" fill="#94a3b8"/></svg>Home</a>
  <a class="tab" href="/nearby.html" aria-label="Nearby"><svg viewBox="0 0 24 24" fill="none"><path d="M12 22s7-6.5 7-12a7 7 0 0 0-14 0c0 5.5 7 12 7 12Zm0-9a3 3 0 1 1 0-6 3 3 0 0 1 0 6Z" fill="#94a3b8"/></svg>Nearby</a>
  <a class="tab" href="/receipts.html" aria-label="Receipts"><svg viewBox="0 0 24 24" fill="none"><path d="M6 2h12a1 1 0 0 1 1 1v18l-3-2-3 2-3-2-3 2-3-2V3a1 1 0 0 1 1-1Z" fill="#94a3b8"/></svg>Receipts</a>
  <a class="tab active" href="/cart.html" aria-label="Cart"><svg viewBox="0 0 24 24" fill="none"><path d="M7 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm10 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6 6h14l-2 8H8L6 4H3" fill="#94a3b8"/></svg>Cart</a>
  <a class="tab" href="/profile.html" aria-label="Profile"><svg viewBox="0 0 24 24" fill="none"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 2.5-9 5v1h18v-1c0-2.5-4-5-9-5Z" fill="#94a3b8"/></svg>Profile</a>
</nav>

<footer class="footer">Â© 2025 Grocery Web</footer>
<script src="/scripts/session.js"></script>
<script>
document.addEventListener('DOMContentLoaded', async () => {
  const orderItems = document.getElementById('order-items');
  const orderTotal = document.getElementById('order-total');
  const urlParams = new URLSearchParams(window.location.search);
  const sessionId = urlParams.get('session_id');
  
  if (sessionId) {
    try {
      const response = await fetch(`/api/orders/${sessionId}`, {
        method: 'GET',
        credentials: 'include' // Send cookies
      });
      if (!response.ok) throw new Error((await response.json()).error || 'Failed to load order');
      const order = await response.json();
      orderItems.innerHTML = order.items.map(item => `
        <div style="display:flex; justify-content:space-between; margin-bottom:8px">
          <div>${item.name} (${item.store}) x${item.quantity}</div>
          <div>$${ (item.quantity * item.price).toFixed(2) }</div>
        </div>
      `).join('');
      orderTotal.textContent = order.total.toFixed(2);
    } catch (err) {
      orderItems.innerHTML = `<p>Error: ${err.message}</p>`;
    }
  }
});
</script>
</body>
</html>